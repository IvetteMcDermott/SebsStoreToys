{% extends "base.html" %}
{% load static %}
{% load crispy_forms_tags %}


{% block head %}


{% endblock %}

{% block content %}

<h3>Ware detail</h3>

<div class="p-2 bd-highlight">
    <a href="javascript:history.go(-1)">
        <h4>
            Back
        </h4>
    </a>
</div>

<!-- BOOKMARK -->
<div class="row-flex d-flex justify-content-end w-100 align-top" style="top:0px;">
    {% if user.is_authenticated %}
    <form method="post" action="{% url 'bookmarks:toggle_bookmark' ware.id %}">
        {% csrf_token %}
        {% if bookmarked %}
        <button type="submit" name="bookmark" value="{{ ware.id }}" class="btn btn-outline-danger">Unpin<i
                class="bi bi-pin-angle-fill"></i></button>
        {% else %}
        <button type="submit" name="bookmark" value="{{ ware.id }}" class="btn btn-outline-info">
            Pin<i class="bi bi-pin-angle"></i></button>

        {% endif %}
    </form>
    {% endif %}
</div>
<!-- -->
<div>

    <a href="{% url 'sts_store:ware_edit' ware.id %}" class="btn btn-outline-warning" style="z-index: 2;">Edit</a>

    <!---->

    <div class="col d-flex justify-content-center">
        <form method="get" action="{% url 'sts_store:ware_delete' ware.id %}" style="margin-top: 1.3em;">


            <button type="button" class="btn btn-outline-danger" data-toggle="modal"
                data-target="#exampleModal-{{ ware.id }}" data-backdrop="false">Delete</button>

            <!-- MODAL FOR DELETE WARE -->
            <div class="modal fade" id="exampleModal-{{ ware.id }}" tabindex="-1" role="dialog"
                aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header" style="background-color: black;">
                            <h5 class="modal-title" id="exampleModalLabel">Do you want to delete this ware?</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body" style="background-color: black;">
                            {% csrf_token %}
                            {{ ware.name }}
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                            <button type="submit" class="btn btn-danger">Delete</button>
                        </div>
                    </div>
                </div>
            </div>

        </form>
    </div>

    <!---->

</div>
<div>
    <p>name: {{ ware.name }}</p>
    <p>{{ ware.get_rating_total }} </p>
    <p>subcat: {{ ware.subcategory }}</p>
    <p>cat: {{ ware.subcategory.category }}</p>
    <p>subcat: {{ ware.price }}</p>
</div>

{% if request.user.is_staff %}


{% for photo in ware.ware_image.all %}
<a href="{% url 'sts_store:open_image' photo.id %}" target="_blank"> <img src="{{ photo.image.url }}"
        alt="{{ photo.caption }}" style="width: 400px;"></a>
<p>{{ photo.caption }}</p>
{{ photo.id }}

{% endfor %}


{% else %}

{% for photo in ware.ware_image.all %}
<img src="{{ photo.image.url }}" alt="{{ photo.caption }}" style="width: 400px;">
<p>{{ photo.caption }}</p>
{{ photo.id }}
{% endfor %}
{% endif %}

<p>leave a review of the ware <a href="" data-toggle="modal" data-target="#ReviewForm" data-backdrop="false"> Here!</a>
</p>

<div>
    <p>Reviews:</p>
    {% for review in reviews %}
    <span>{{ review.rating }} <i class="fa-solid fa-star"></i></span>
    <p>{{ review.body }}</p>
    <p>{{ review.author }}</p>
    <p>{{ review.date_created }}</p>


    {% endfor %}
</div>

{% include 'cart/quantity_form.html' %}
{% include 'reviews/reviews_form.html' %}

{% endblock %}